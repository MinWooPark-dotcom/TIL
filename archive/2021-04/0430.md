# Deployment

AWS RDS를 사용하여 데이터베이스를 구축하였습니다.
진행 과정을 기록하며 정리하는 글을 작성하겠습니다.

---

## RDS(Relational Database Service)

RDS는 관계형 데이터베이스(RDBMS,Relational Database management system)를 간편하게 생성하고 확장할 수 있는 서비스입니다.
데이터베이스에 특화된 EC2컴퓨터입니다.

RDS의 장점은 성능, 편의성, 시간 절약, 비용 절감에 있습니다.
손쉽게 DB 인스턴스를 생성할 수 있고 사용량이 늘어나면 성능 확장이 간편합니다.

전문 인력이 아니더라도 쉽게 사용이 가능합니다.

### 1. 데이터베이스 생성

RDS 서비스 첫 화면에서 데이터베이스 생성을 클릭합니다.

> RDS 서비스 첫 화면
> ![](https://images.velog.io/images/qmasem/post/7b90aa1e-2ef5-44e4-98a3-0969ae79421c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.39.15.png)

다음과 같은 화면이 나옵니다.
여러 설정들이 있는데 제가 사용한 기본적인 설정들만 언급하겠습니다.

> 데이터 베이스 생성 - 방식, 엔진 옵션, 템플릿
> ![](https://images.velog.io/images/qmasem/post/84dbee4b-fc97-4531-bbed-1269427827eb/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.42.22.png)

데이터베이스 생성 방식 선택정보는 표준 생성으로 선택합니다.
버전은 자신이 사용하는 버전으로 선택합니다.
템플릿은 프리티어를 사용해야 750시간 무료로 사용 가능합니다.

다음은 설정 칸입니다.
식별자, 마스터 사용자 이름, 암호를 입력합니다.

식별자는 mysql에 접속할 때 엔드포인트에 들어가는 이름입니다.
마스터 사용자 이름은 mysql 유저 이름이고
암호는 mysql 패스워드입니다.

> 데이터베이스 생성 - 설정
> ![](https://images.velog.io/images/qmasem/post/fa0b30e2-e90a-415d-994e-f1e0c0981c25/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.46.09.png)

설정에서 입력을 다 끝냈으면 연결 탭까지 쭉 내려갑니다.

먼저 퍼블릭 엑세스 가능을 예로 선택합니다.
퍼블릭 액세스 가능성이 아니요로 되어있으면 cli로 mysql 접속할 수가 없습니다.

연결에서 추가 연결 구성을 클릭하면 데이터베이스 포트가 나옵니다.
MySQL의 기본 값 3306이 나오는데 보안상 외부에 노출하지 않기 위해서 임의로 포트번호를 바꿉니다.

이 포트번호는 추후에 보안 그룹 설정 시 포트번호로 입력해 줘야 합니다.

> 데이터베이스 생성 - 연결 - 추가 연결 구성
> ![](https://images.velog.io/images/qmasem/post/f716716e-d85e-4da5-af76-1579ec6badf3/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.52.32.png)
> ![](https://images.velog.io/images/qmasem/post/32a34915-b856-492a-bf80-ddd076022025/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.53.38.png)

마지막으로 추가 구성 탭에서 데이터베이스 이름을 입력합니다.
그리고 맨 아래 생성하기 버튼을 클릭합니다.

> 데이터베이스 생성 - 추가 구성
> ![](https://images.velog.io/images/qmasem/post/8fe29e6c-8fce-4577-8a6e-4994b5eef0ba/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202021-04-28%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%204.56.27.png)

데이터베이스가 생성되면 연결&보안 탭에서 엔드포인트를 확인할 수 있습니다.
엔드포인트는 mysql 접속 시 host에 입력하면 되고 구성 탭에서 master name은 user에 입력하면 됩니다.

---

### 2. 데이터베이스 접속

데이터베이스에 접속해 보겠습니다.
user, host, port number, paswword가 필요합니다.
유저네임은 db 생성 시 마스터 사용자 이름에 작성했던 이름입니다.
host는 데이터베이스의 엔드포인트입니다.
포트번호는 데이터베이스 포트인데 기본 값 3306이 아닌 다른 값을 입력했다면 넣어줘야 합니다.
password는 마스터 암호입니다.
이를 토대로 터미널에서 다음과 같이 입력하면 됩니다.

> mysql -u [마스터 이름] -h [엔드포인트] -P [포트번호] -p [마스터 암호]

제대로 접속했다면 Welcome 문구가 나오면서 터미널이 'mysql>' 로 변경됬음을 확인할 수 있습니다.

---

### 3. Sequelize 연결

시퀄라이즈 연결은 로컬에서 MySQL을 사용하는 것과 동일합니다.
단지 위에서 입력한대로 user, host, port number, password만 rds로 입력하여 넣어주면 됩니다.

---

Reference : [AWS 공식문서 MySQL 데이터베이스 엔진 기반 DB 인스턴스에 연결하기](https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/USER_ConnectToInstance.html)
